dist: trusty

language: node_js

node_js:
  - "stable"

addons:
  sonarcloud:
    organization: "sproogen-github"

cache:
  directories:
    - node_modules

branches:
  only:
    - master
    - develop

before_install:
  - git fetch origin +refs/heads/*:refs/remotes/origin/*
  - ./scripts/update-sonar-version.sh

script:
  - npm run lint -- -f json -o eslint-report.json
  - npm test -- --coverage --ci
  - npm run build
  - sonar-scanner
